(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('d3')) :
	typeof define === 'function' && define.amd ? define(['d3'], factory) :
	(global.RadarChart = factory(global.d3));
}(this, (function (d3) { 'use strict';

var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};var max=Math.max; var sin=Math.sin; var cos=Math.cos; var HALF_PI=Math.PI/2; var wrap=function(a,b){a.each(function(){for(var a=d3.select(this),c=a.text().split(/\s+/).reverse(),d=a.attr('y'),e=a.attr('x'),f=parseFloat(a.attr('dy')),g=[],h=0,i=a.text(null).append('tspan').attr('x',e).attr('y',d).attr('dy',f+'em'),j=c.pop();j;)g.push(j),i.text(g.join(' ')),i.node().getComputedTextLength()>b&&(g.pop(),i.text(g.join(' ')),g=[j],i=a.append('tspan').attr('x',e).attr('y',d).attr('dy',++h*1.4+f+'em').text(j)),j=c.pop();});}; var move=function(a,b,c){return a.splice(c,0,a.splice(b,1)[0]),a}; var swap=function(a,b,c){var d=[a[c],a[b]];return a[b]=d[0],a[c]=d[1],a}; var RadarChart=function(a,b,c){var d=this,e=this,f={w:600,h:600,margin:{top:20,right:20,bottom:20,left:20},levels:3,maxValue:0,labelFactor:1.25,wrapWidth:60,opacityArea:0.35,dotRadius:4,opacityCircles:0.1,strokeWidth:2,roundStrokes:!1,color:d3.scaleOrdinal(d3.schemeCategory10),format:'.2%',unit:'',legend:!1,allowInverseData:!1};if('undefined'!=typeof c)for(var y in c)'undefined'!=typeof c[y]&&(f[y]=c[y]);for(var i,z=[],A=0,B=0;B<b.length;B++){i=[];for(var j=0;j<b[B].axes.length;j++)b[B].axes[j].id=b[B].name,i.push(b[B].name),b[B].axes[j].value>A&&(A=b[B].axes[j].value),z.push(i);}maxValue=max(f.maxValue,maxValue),this.allAxis=b[0].axes.map(function(a){return a.axis});var h=this.allAxis.length,k=Math.min(f.w/2,f.h/2),l=d3.format(f.format),m=2*Math.PI/h,n=d3.scaleLinear().range([0,k]).domain([0,maxValue]),o=d3.select(a);o.select('svg').remove();var p=o.append('svg').attr('width',f.w+f.margin.left+f.margin.right).attr('height',f.h+f.margin.top+f.margin.bottom).attr('class','radar'),q=p.append('g').attr('transform','translate('+(f.w/2+f.margin.left)+','+(f.h/2+f.margin.top)+')'),g=q.append('defs').append('filter').attr('id','glow');g.append('feGaussianBlur').attr('stdDeviation','2.5').attr('result','coloredBlur');var r=g.append('feMerge');r.append('feMergeNode').attr('in','coloredBlur'),r.append('feMergeNode').attr('in','SourceGraphic');var s=q.append('g').attr('class','axisWrapper');s.selectAll('.levels').data(d3.range(1,f.levels+1).reverse()).enter().append('circle').attr('class','gridCircle').attr('r',function(a){return k/f.levels*a}).style('fill','#CDCDCD').style('stroke','#CDCDCD').style('fill-opacity',f.opacityCircles).style('filter','url(#glow)'),s.selectAll('.axisLabel').data(d3.range(1,f.levels+1).reverse()).enter().append('text').attr('class','axisLabel').attr('x',4).attr('y',function(a){return-a*k/f.levels}).attr('dy','0.4em').style('font-size','10px').attr('fill','#737373').text(function(a){return l(maxValue*a/f.levels)+f.unit});var t=s.selectAll('.axis').data(this.allAxis).enter().append('g').attr('class','axis');t.append('line').attr('x1',0).attr('y1',0).attr('x2',function(a,b){return n(1.1*maxValue)*cos(m*b-HALF_PI)}).attr('y2',function(a,b){return n(1.1*maxValue)*sin(m*b-HALF_PI)}).attr('class','line').style('stroke','white').style('stroke-width','2px'),t.append('text').attr('class','legend').style('font-size','11px').attr('id',function(a,b){return b}).attr('text-anchor','middle').attr('dy','0.35em').attr('x',function(a,b){return n(maxValue*f.labelFactor)*cos(m*b-HALF_PI)}).attr('y',function(a,b){return n(maxValue*f.labelFactor)*sin(m*b-HALF_PI)}).text(function(a){return a}).on('click',function(){var a=+this.id;if(a+1===e.allAxis.length)for(var b=0;b<e.data.length;b++)swap(e.data[b].axes,a,0);else for(var c=0;c<e.data.length;c++)move(e.data[c].axes,a,a+1);e.update_data();}).call(wrap,f.wrapWidth);var u=d3.radialLine().curve(f.roundStrokes?d3.curveCardinalClosed:d3.curveLinearClosed).radius(function(a){return n(a.value)}).angle(function(a,b){return b*m}),v=q.selectAll('.radarWrapper').data(b).enter().append('g').attr('class','radarWrapper');v.append('path').attr('class','radarArea').attr('d',function(a){return u(a.axes)}).style('fill',function(a,b){return f.color(b)}).style('fill-opacity',0).style('fill-opacity',f.opacityArea).on('mouseover',function(){v.selectAll('.radarArea').transition().duration(200).style('fill-opacity',0.1),d3.select(this).transition().duration(200).style('fill-opacity',0.7);}).on('mouseout',function(){v.selectAll('.radarArea').transition().duration(200).style('fill-opacity',f.opacityArea);}),v.append('path').attr('class','radarStroke').attr('d',function(a){return u(a.axes)}).style('stroke-width',f.strokeWidth+'px').style('stroke',function(a,b){return f.color(b)}).style('fill','none').style('filter','url(#glow)'),v.selectAll('.radarCircle').data(function(a){return a.axes}).enter().append('circle').attr('class','radarCircle').attr('r',f.dotRadius).attr('cx',function(a,b){return n(a.value)*cos(m*b-HALF_PI)}).attr('cy',function(a,b){return n(a.value)*sin(m*b-HALF_PI)}).style('fill',function(a){return f.color(a.id)}).style('fill-opacity',0.8);var w=q.append('text').attr('class','tooltip').attr('x',0).attr('y',0).style('font-size','12px').style('display','none').attr('text-anchor','middle').attr('dy','0.35em'),x=q.selectAll('.radarCircleWrapper').data(b).enter().append('g').attr('class','radarCircleWrapper');if(x.selectAll('.radarInvisibleCircle').data(function(a){return a.axes}).enter().append('circle').attr('class','radarInvisibleCircle').attr('r',1.5*f.dotRadius).attr('cx',function(a,b){return n(a.value)*cos(m*b-HALF_PI)}).attr('cy',function(a,b){return n(a.value)*sin(m*b-HALF_PI)}).style('fill','none').style('pointer-events','all').on('mouseover',function(a){w.attr('x',this.cx.baseVal.value-10).attr('y',this.cy.baseVal.value-10).transition().style('display','block').text(l(a.value)+f.unit);}).on('mouseout',function(){w.transition().style('display','none').text('');}),!1!==f.legend&&'object'===_typeof(f.legend)){var C=p.append('g').attr('id','legendZone').attr('class','legend').attr('transform','translate('+f.legend.translateX+','+(f.legend.translateY+20)+')'),D=b.map(function(a){return a.name});f.legend.title&&C.append('text').attr('class','title').attr('transform','translate(0, -20)').attr('x',f.w-70).attr('y',10).attr('font-size','12px').attr('fill','#404040').text(f.legend.title);var E=C.selectAll('g').data(D).enter().append('g');E.append('rect').attr('x',f.w-65).attr('y',function(a,b){return 20*b}).attr('width',10).attr('height',10).style('fill',function(a){return f.color(a)}),E.append('text').attr('x',f.w-52).attr('y',function(a,b){return 20*b+9}).attr('font-size','11px').attr('fill','#737373').text(function(a){return a});}f.allowInverseData&&(this.inverse_data=function(a){var b=d.data.length;if(!a)for(var c,e=0;e<b;e++){c=d.data[e].axes;for(var f=0;f<c.length;f++)c[f].value=100-c[f].value;}else for(var g,h=0;h<b;h++){g=d.data[h].axes;for(var i=0;i<g.length;i++)g[i].axis===a&&(g[i].value=100-g[i].value);}d.update_data();}),this.add_element=function(a){var b=a.axes.map(function(a){return a.axis});if(JSON.stringify(b)!==JSON.stringify(d.allAxis))throw new Error('Expected element with same axes name than existing data.');d.data.push(a);},this.update_data=function(a){if(a){var h=a[0].axes.map(function(a){return a.axis});if(h.length!==d.allAxis.length)throw new Error('Invalid number of axis. Can Only update with same axis.');d.data=a,d.allAxis=h;}else d.allAxis=d.data[0].axes.map(function(a){return a.axis});var b=s.selectAll('.axis').data(d.allAxis),c=q.selectAll('.radarWrapper').transition().duration(375);b.select('text.legend').attr('id',function(a,b){return b}).attr('x',function(a,b){return n(maxValue*f.labelFactor)*cos(m*b-HALF_PI)}).attr('y',function(a,b){return n(maxValue*f.labelFactor)*sin(m*b-HALF_PI)}).text(function(a){return a}).call(wrap,f.wrapWidth);var e=q.selectAll('.radarWrapper').data(d.data);e.select('.radarArea').transition(c).attr('d',function(a){return u(a.axes)}),e.select('.radarStroke').transition(c).attr('d',function(a){return u(a.axes)});var g=e.selectAll('.radarCircle').data(function(a){return a.axes});g.transition(c).attr('cx',function(a,b){return n(a.value)*cos(m*b-HALF_PI)}).attr('cy',function(a,b){return n(a.value)*sin(m*b-HALF_PI)}).style('fill',function(a){return f.color(a.id)}).style('fill-opacity',0.8);},this.round_stroke=function(a){return void 0===a?f.roundStrokes:(a!==f.roundStrokes&&(f.roundStrokes=a,u=d3.radialLine().curve(f.roundStrokes?d3.curveCardinalClosed:d3.curveLinearClosed).radius(function(a){return n(a.value)}).angle(function(a,b){return b*m}),d.update_data()),a)},this.data=b;};

return RadarChart;

})));
